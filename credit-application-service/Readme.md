–û—Ç–ª–∏—á–Ω–æ! –ö–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫, —è —Ä–∞–∑–æ–±—å—é –≤—Å—é –∑–∞–¥–∞—á—É **–ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –∏ —Å–æ–±—ã—Ç–∏—è–º**, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –º–æ–≥–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ, –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º**, —Å —á—ë—Ç–∫–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –≤—Ö–æ–¥–æ–≤, –≤—ã—Ö–æ–¥–æ–≤ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

---

## üìå **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –∏ —Å–æ–±—ã—Ç–∏—è–º (–ø–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º)**

–ö–∞–∂–¥—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç ‚Äî —ç—Ç–æ **–≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞** –≤ —Å–µ—Ä–≤–∏—Å.  
–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ ‚Äî —ç—Ç–æ **–≤—ã—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –≤ SAGA.

---

## ‚úÖ 1. `CreditApplicationService`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∑–∞—è–≤–∫–∏, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è SAGA.

### üü¶ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (REST)

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ | –û—Ç–≤–µ—Ç |
|------|------|--------|--------------|-------|
| `POST` | `/api/credit-applications` | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ | `CreateApplicationRequest` | `201 Created`, `application_id` |
| `GET`  | `/api/credit-applications/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏ | ‚Äî | `CreditApplicationResponse` |
| `PUT`  | `/api/credit-applications/{id}/cancel` | –û—Ç–º–µ–Ω–∞ –∑–∞—è–≤–∫–∏ (—Ä—É—á–Ω–∞—è) | ‚Äî | `200 OK` |

#### üì• **Request: CreateApplicationRequest**
```json
{
  "customer_id": "uuid",
  "amount": 500000,
  "term_months": 24
}
```

#### üì§ **Response: CreditApplicationResponse**
```json
{
  "application_id": "uuid",
  "customer_id": "uuid",
  "amount": 500000,
  "term_months": 24,
  "status": "CREATED",
  "created_at": "2025-04-05T10:00:00Z"
}
```

---

### üü® –°–æ–±—ã—Ç–∏—è (Kafka ‚Äî –∏—Å—Ö–æ–¥—è—â–∏–µ)

| –°–æ–±—ã—Ç–∏–µ | –¢–µ–º–∞ (Topic) | –ö–æ–≥–¥–∞ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è | –¢–µ–ª–æ |
|--------|--------------|------------------|------|
| `CREDIT_APPLICATION_CREATED` | `credit.applications.created` | –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î + Outbox | `{ "application_id", "customer_id", ... }` |
| `CUSTOMER_VERIFICATION_REQUESTED` | `customer.verification.requested` | –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ (—à–∞–≥ 1 SAGA) | `{ "application_id", "customer_id" }` |
| `SCORING_REQUESTED` | `scoring.requested` | –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ | `{ "application_id", "customer_id", "amount", "term_months" }` |
| `FUNDS_RESERVATION_REQUESTED` | `funds.reservation.requested` | –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞ | `{ "application_id", "amount" }` |
| `NOTIFICATION_REQUESTED` | `notification.requested` | –ü–æ—Å–ª–µ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤ | `{ "application_id", "customer_id", "loan_terms" }` |
| `LOAN_CREATED` | `loan.created` | –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | `{ "application_id", "loan_id", "amount", "interest_rate", "start_date" }` |

---

### üü• –°–æ–±—ã—Ç–∏—è (Kafka ‚Äî –≤—Ö–æ–¥—è—â–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞)

| –°–æ–±—ã—Ç–∏–µ | –¢–µ–º–∞ | –û–±—Ä–∞–±–æ—Ç—á–∏–∫ | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|------|-----------|---------|
| `customer.verification.completed` | `customer.verification.completed` | `OnCustomerVerifiedHandler` | –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–∫–æ—Ä–∏–Ω–≥—É |
| `scoring.approved` | `scoring.approved` | `OnScoringApprovedHandler` | –ó–∞–ø—Ä–æ—Å —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤ |
| `scoring.rejected` | `scoring.rejected` | `OnScoringRejectedHandler` | –û—Ç–∫–∞—Ç SAGA |
| `funds.reservation.completed` | `funds.reservation.completed` | `OnFundsReservedHandler` | –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `funds.reservation.failed` | `funds.reservation.failed` | `OnFundsReservationFailedHandler` | –û—Ç–∫–∞—Ç SAGA |
| `notification.sent` | `notification.sent` | `OnNotificationSentHandler` | –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞ |
| `loan.activated` | `loan.activated` | `OnLoanActivatedHandler` | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ SAGA, —Å—Ç–∞—Ç—É—Å `COMPLETED` |

---

## üìå **–ò—Ç–æ–≥: –ö–∞–∫ –¥–µ–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–µ–∂–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏**

| –ö–æ–º–∞–Ω–¥–∞ | –ó–∞–¥–∞—á–∏ |
|--------|-------|
| **–ö–æ–º–∞–Ω–¥–∞ 1: CreditApplicationService** | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å REST API, SAGA Orchestrator, Outbox, –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π |
| **–ö–æ–º–∞–Ω–¥–∞ 2: CustomerVerification + Scoring** | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞—è–≤–æ–∫, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, –ø—É–±–ª–∏–∫–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ |
| **–ö–æ–º–∞–Ω–¥–∞ 3: PaymentService** | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—é —Å—Ä–µ–¥—Å—Ç–≤, —Å–æ–±—ã—Ç–∏—è, –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é |
| **–ö–æ–º–∞–Ω–¥–∞ 4: NotificationService** | –û—Ç–ø—Ä–∞–≤–∫–∞ email, —Å–æ–±—ã—Ç–∏—è |
| **–ö–æ–º–∞–Ω–¥–∞ 5: LoanManagementService** | CRUD –∫—Ä–µ–¥–∏—Ç–∞, –≥—Ä–∞—Ñ–∏–∫, —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è |

---

## üìé **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

### üìÑ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ A: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö Kafka-—Ç–æ–ø–∏–∫–æ–≤
| –¢–æ–ø–∏–∫ | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------------|---------|
| `credit.applications.created` | out | –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ |
| `customer.verification.requested` | out | –ó–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ |
| `customer.verification.completed` | in | –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| `scoring.requested` | out | –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–∫–æ—Ä–∏–Ω–≥ |
| `scoring.approved` | in | –£—Å–ø–µ—à–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ |
| `funds.reservation.requested` | out | –ó–∞–ø—Ä–æ—Å —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ |
| `funds.reservation.completed` | in | –°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã |
| `notification.requested` | out | –ó–∞–ø—Ä–æ—Å –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ |
| `loan.created` | out | –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞ |
| `saga.compensate.*` | - | –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

---

–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∑–Ω–∞–µ—Ç:
- –ö–∞–∫–∏–µ **—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å,
- –ö–∞–∫–∏–µ **—Å–æ–±—ã—Ç–∏—è** —Å–ª—É—à–∞—Ç—å –∏ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å,
- –ö–∞–∫–∏–µ **–¥–µ–π—Å—Ç–≤–∏—è** –≤—ã–ø–æ–ª–Ω—è—Ç—å.

–ì–æ—Ç–æ–≤ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É ‚úÖ  
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **Jira-—ç–ø–∏–∫–∏ –∏ –∑–∞–¥–∞—á–∏** –∏–ª–∏ **Swagger-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏**.